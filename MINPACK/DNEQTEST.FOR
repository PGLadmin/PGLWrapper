C
C  DRIVER FOR DNEQNF EXAMPLE.
C
CCC      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER J,N,LWA,NWRITE!,INFO
      DOUBLE PRECISION TOL,FNORM
      DOUBLE PRECISION X(9)!,FVEC(9)!,WA(180)
      !DOUBLE PRECISION ENORM !,DPMPAR
      EXTERNAL FUN
C
C  LOGICAL OUTPUT UNIT IS ASSUMED TO BE NUMBER 6.
C
      DATA NWRITE/6/
C
      N=4
C
C  THE FOLLOWING STARTING VALUES PROVIDE A ROUGH SOLUTION.
C
      DO 10 J=1,9
        X(J)=-1.D0
10    CONTINUE
C
      LWA=180
C
C  SET TOL TO THE SQUARE ROOT OF THE MACHINE PRECISION.
C  UNLESS HIGH PRECISION SOLUTIONS ARE REQUIRED,
C  THIS IS THE RECOMMENDED SETTING.
C
C      TOL=SQRT(DPMPAR(1))
      TOL=1.0D-4
      ITMAX=100
C
      CALL DNEQNF(FUN,TOL,N,ITMAX,X,X,FNORM)
	!the answers should be:
	!-0.5546, -0.6394,-0.5907,-0.4153
      WRITE(NWRITE,1000)FNORM,(X(J),J=1,N)
      STOP
1000  FORMAT(5X,31H FINAL L2 NORM OF THE RESIDUALS,D15.7//
     &       5X,27H FINAL APPROXIMATE SOLUTION//(5X,9D15.7))
c     &       5X,15H EXIT PARAMETER,16X,I10//
      END
      SUBROUTINE  FUN(X,FVEC,N)
CCC      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER N!,IFLAG
      DOUBLE PRECISION X(N),FVEC(N)
C
C  SUBROUTINE FUN FOR HYBRD1 EXAMPLE.
C
      INTEGER K
      DOUBLE PRECISION ONE,TEMP,TEMP1,TEMP2,THREE,TWO,ZERO
      DATA ZERO,ONE,TWO,THREE/0.D0,1.D0,2.D0,3.D0/
C
      !K=IFLAG
      DO 10 K=1,N
        TEMP=(THREE-TWO*X(K))*X(K)
        TEMP1=ZERO
        IF(K.NE.1)TEMP1=X(K-1)
        TEMP2=ZERO
        IF(K.NE.N)TEMP2=X(K+1)
        FVEC(K)=TEMP-TEMP1-TWO*TEMP2+ONE
        WRITE(6,*)K,X(K),FVEC(K)
10    CONTINUE
      RETURN
      END
C$INCLUDE:'DNEQNF.FOR'
