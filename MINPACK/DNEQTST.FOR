C  DRIVER FOR DNEQNF EXAMPLE. DNEQTST.FOR
C
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      DOUBLE PRECISION X(9),FVEC(9)
      EXTERNAL FUN
C  SET THE NUMBER OF EQUATIONS TO BE SOLVED.
      N=9
C
C  THE FOLLOWING STARTING VALUES PROVIDE A ROUGH SOLUTION.(INITIAL GUESS)
C
      DO 10 J=1,9
        X(J)=-1.D0
10    CONTINUE
C
C  SET TOL TO GIVE 4 SIG FIGS ACCURACY.
      TOL=1.0D-4
C  SET THE MAXIMUM NUMBER OF ITERATIONS.
      ITMAX=100
C  CALL THE SUBROUTINE CITING "FUN" AS THE LOCATION OF THE FUNCTIONS.
      CALL DNEQNF(FUN,TOL,N,ITMAX,X,X,FNORM)
C  COMPUTE THE SUM OF SQUARED ERRORS TO CHECK THAT THE SOLUTION IS RIGHT.
      FNORM=ENORM(N,FVEC)
C  WRITE THE RESULTS TO THE SCREEN.
      WRITE(*,1000)FNORM,(X(J),J=1,N)
      STOP
1000  FORMAT(5X,31H FINAL L2 NORM OF THE RESIDUALS,D15.7//
     &       5X,15H EXIT PARAMETER,16X,//
     &       5X,27H FINAL APPROXIMATE SOLUTION//(5X,3D15.7))
      END

      SUBROUTINE FUN(X,FVEC,N)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      DIMENSION X(N),FVEC(N)
C  SUBROUTINE FUN FOR DNEQNF EXAMPLE.
      FVEC(1)=(3-2*X(1))*X(1)-  0 -2*X(2)+1
      FVEC(2)=(3-2*X(2))*X(2)-X(1)-2*X(3)+1
      FVEC(3)=(3-2*X(3))*X(3)-X(2)-2*X(4)+1
      FVEC(4)=(3-2*X(4))*X(4)-X(3)-2*X(5)+1
      FVEC(5)=(3-2*X(5))*X(5)-X(4)-2*X(6)+1
      FVEC(6)=(3-2*X(6))*X(6)-X(5)-2*X(7)+1
      FVEC(7)=(3-2*X(7))*X(7)-X(6)-2*X(8)+1
      FVEC(8)=(3-2*X(8))*X(8)-X(7)-2*X(9)+1
      FVEC(9)=(3-2*X(9))*X(9)-X(8)-  0   +1
      RETURN
      END
