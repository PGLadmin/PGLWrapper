      SUBROUTINE UVMGS(SFUN,KIJ0,KIJ3,TOL,XMIN)

C
C  PURPOSE:  BP CALCULATIONS TO DETERMINE THE OPTIMAL
C    VALUE FOR THE BINARY INTERACTION COEFFICIENT (Kij) FOR A SERIES
C    OF EXPERIMENTAL DATA SPECIFIED BY USER THROUGH PROMPT.
C  NOTE:  OPTIMAL KIJ IS PASSED THROUGH COMMON STATEMENT
C  PROGRAMMED BY:  JRE 2/96
C  METHOD:   GOLDEN SECTION SEARCH ON A SINGLE PARAMETER
C  REFERENCE:NUMERICAL RECIPES
C
      IMPLICIT DOUBLE PRECISION(A-H,K,O-Z)
	EXTERNAL SFUN
      CHARACTER*44 FN
      PARAMETER (NMX=10)
      PARAMETER (RGOLD=.61803399,CGOLD=.38196602)
      
C      DIMENSION TC(NMX),PC(NMX),ACEN(NMX),ID(NMX)
C      DIMENSION TDAT(111),PDAT(111),XD(111),YD(111)
C      COMMON/ETA/ETAL,ETAV,ZL,ZV
C      COMMON/CONSTK/KIJ(NMX,NMX),INITIAL
C
C      WRITE(*,*)'ENTER NAME OF FILE WITH EXPERIMENTAL DATA (PATH\FN.FT)'
C      READ(*,'(A)')FN
C      OPEN(51,FILE=FN)
C      READ(51,*)NPTS
C      DO 5 I=1,NPTS
C        READ(51,*)TDAT(I),PDAT(I),XD(I),YD(I)
C        WRITE(*,*)TDAT(I),PDAT(I),XD(I),YD(I)
C5	CONTINUE
	MAXIT=1111
C      INIT=1
C      WRITE(*,*)'THIS ROUTINE ASSUMES A BINARY SYSTEM FROM MAIN PROGRAM'
C      WRITE(6,*)'ENTER RANGE FOR KIJ TO OPTIMIZE, (KIJLO KIJHI)  '
C      READ(5,*)KIJ0,KIJ3                                          
      KIJ1=KIJ0+CGOLD*(KIJ3-KIJ0)
      KIJ2=KIJ0+RGOLD*(KIJ3-KIJ0)
      L=0
      CALL SFUN(KIJ0,PAAD0)
      CALL SFUN(KIJ1,PAAD1)
      CALL SFUN(KIJ2,PAAD2)
      CALL SFUN(KIJ3,PAAD3)
      TOL2=0.002      
1000  IF(ABS(KIJ3-KIJ0).GT.TOL*(ABS(KIJ1)+ABS(KIJ2)))THEN
        IF(PAAD2.LT.PAAD1)THEN
          KIJ0=KIJ1
          KIJ1=KIJ2
          KIJ2=RGOLD*KIJ1+CGOLD*KIJ3
          PAAD0=PAAD1
          PAAD1=PAAD2
          CALL SFUN(KIJ2,PAAD2)
        ELSE
          KIJ3=KIJ2
          KIJ2=KIJ1
          KIJ1=RGOLD*KIJ2+CGOLD*KIJ0
          PAAD3=PAAD2
          PAAD2=PAAD1
          CALL SFUN(KIJ1,PAAD1)
C         CALL KIJVAL(NC,ID,TC,PC,ACEN,NPTS,TDAT,PDAT,XD,YD,KIJ1,PAAD1,L)
        ENDIF
      GOTO 1000
      ENDIF
      IF(PAAD1.LT.PAAD2)THEN
        PAADP=PAAD1
        KIJB=KIJ1
      ELSE
        PAADP=PAAD2
        KIJB=KIJ2
      ENDIF    
      WRITE(*,*)'OPTPARM, PAADP'
      WRITE(*,606)KIJB,PAADP
	XMIN=KIJB
C     	LAST=1
C      CALL SFUN(KIJB,PAAD1)
C      CALL KIJVAL(NC,ID,TC,PC,ACEN,NPTS,TDAT,PDAT,XD,YD,KIJB,PAAD1,LAST)


606   FORMAT(1X,F8.4,1X,F10.2)      
C      close(51)
	RETURN
      END

